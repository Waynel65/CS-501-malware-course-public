
{
    "binaries": 
    [
        {
            "binary_name": "invoice.docs.exe",
            "sha256": "b80947799ba2f5416a9077fc22ad3d63951d209f7fe67b27f72938612cfa0e9e",
            "imphash": "cefd6e93ee239f140a8acc2be2555efd",
            "arch": 64,
            "compile_time": 1645497754,
            "strings": [
                "https://ch0nky.chickenkiller.com/FreeCandy.exe",
                "FreeCandy.exe",
                "C:\\malware\\ch0nky.txt"
            ],
            "imports": {
                "KERNEL32.dll": [
                    "CreateProcessW",
                    "FreeConsole",
                    "VirtualProtect"
                ],
            
                "SHLWAPI.dll": [
                    "PathCombineW"
                ],
            
                "USER32.dll": [
                    "MessageBoxA"
                ],
                "WININET.dll": [
                    "DeleteUrlCacheEntryW",
                    "UrlMkSetSessionOption"
                ],
            
                "urlmon.dll": [
                    "URLDownloadToFileW"
                ]
            },
            "iocs": [
                {
                    "type": "sha256",
                    "Value": "b80947799ba2f5416a9077fc22ad3d63951d209f7fe67b27f72938612cfa0e9e",
                    "Comments": "sha256 Hash of the invoice.docs.exe"
                },
                {
                    "type": "imphash",
                    "Value": "cefd6e93ee239f140a8acc2be2555efd",
                    "Comments": "Imphash of invoice.docs.exe"
                },
                {
                    "type": "file_name",
                    "Value": "invoice.docs.exe",
                    "Comments": "Malicious EXE filename that entices user to mistaken with a regular .docx file"
                },
                {
                    "type": "PE_string",
                    "Value": "C:\\malware\\ch0nky.txt",
                    "Comments": "setting an environment for the malware to run"
                },
                {
                    "type": "URL",
                    "Value": "https://ch0nky.chickenkiller.com/FreeCandy.exe",
                    "Comments": "Evil url"
                },
                {
                    "type": "domain",
                    "Value": "ch0nky.chickenkiller.com",
                    "Comments": "evil domain"
                },
                {
                    "type": "file_name",
                    "Value": "FreeCandy.exe",
                    "Comments": "dropped file"
                }
            ],
            "mitre_att&ck": {
                "TA0002": {
                    "Techniques": [
                        "T1106",
                        "T1204"
                    ],
                    "Comments": "<Native API:Call to CreateProcess> and social engineering to get user to execute malware"
                },
                "TA0011": {
                    "Techniques": [
                        "T1071"
                    ],
                    "Comments": "<Application Layer Protocol:Downloads via HTTP>"
                },
                "TA0005": {
                    "Techniques": [
                        "T1564"
                    ],
                    "Comments": "<Hide Artifacts:FreeConsole>"
                }
            },
            "verdict": true,
            "classification": "dropper",
            "verdict_justification": "downloads and executes malicious file"
        },

        {
            "binary_name": "FreeCandy.exe",
            "sha256": "862e7e0c0146376ae91b53ebda2f79ee1088a18a45b096a041572fdc18250eda",
            "imphash": "177a919d405e1336d14e4aeaedec2ebd",
            "arch": 64,
            "compile_time": 1645497754,
            "strings": [
                "https://ch0nky.chickenkiller.com/stage2.exe",
                "stage2.exe",
                "C:\\malware\\ch0nky.txt"
            ],
            "imports": {
                "KERNEL32.dll": [
                    "CreateProcessA",
                    "FreeConsole",
                    "LoadLibraryA",
                    "VirtualProtect"
                ],
                "SHLWAPI.dll": [
                    "PathCombineA"
                ],
                "USER32.dll": [
                    "MessageBoxA"
                ],
            
                "WININET.dll": [
                    "DeleteUrlCacheEntryW",
                    "UrlMkSetSessionOption"
                ],
            
                "urlmon.dll": [
                    "URLDownloadToFileW"
                ]
            },
            "iocs": [
                {
                    "type": "sha256",
                    "Value": "862e7e0c0146376ae91b53ebda2f79ee1088a18a45b096a041572fdc18250eda",
                    "Comments": "sha256 Hash of the FreeCandy.exe"
                },
                {
                    "type": "imphash",
                    "Value": "177a919d405e1336d14e4aeaedec2ebd",
                    "Comments": "Imphash of FreeCandy.exe"
                },
                {
                    "type": "PE_string",
                    "Value": "C:\\malware\\ch0nky.txt",
                    "Comments": "setting an environment for the malware to run"
                },
                {
                    "type": "URL",
                    "Value": "https://ch0nky.chickenkiller.com/stage2.exe",
                    "Comments": "Evil url"
                },
                {
                    "type": "domain",
                    "Value": "ch0nky.chickenkiller.com",
                    "Comments": "evil domain"
                },
                {
                    "type": "file_name",
                    "Value": "stage2.exe",
                    "Comments": "dropped file"
                },
                {
                    "type": "DLL",
                    "Value": "UrlMkSetSessionOption",
                    "Comments": "a DLL function hidden in stack strings"
                }
            ],
            "mitre_att&ck": {
                "TA0002": {
                    "Techniques": [
                        "T1106"
                    ],
                    "Comments": "<Native API:Call to CreateProcess>"
                },
                "TA0011": {
                    "Techniques": [
                        "T1071"
                    ],
                    "Comments": "<Application Layer Protocol:Downloads via HTTP>"
                },
                "TA0005": {
                    "Techniques": [
                        "T1564"
                    ],
                    "Comments": "<Hide Artifacts:FreeConsole>"
                }
            },
            "verdict": true,
            "classification": "dropper",
            "verdict_justification": "downloads and executes malicious file"
        },

        {
            "binary_name": "stage2.exe",
            "sha256": "c8420237b108ab3a1ea1f2aaa1476a8213051f78177c1ce97c9a38250798cb27",
            "imphash": "040bf8c6dc77209e89ac091aee70ec76",
            "arch": 64,
            "compile_time": 1645497796,
            "strings": [
                "C:\\malware\\ch0nky.txt",
                "167.172.135.86",
                "powershell.exe"
            ],
            "imports": {
                "KERNEL32.dll": [
                    "CreateProcessA",
                    "CreateThread",
                    "FreeConsole",
                    "GetFileAttributesA",
                    "GetStartupInfoA",
                    "Sleep",
                    "TlsGetValue",
                    "VirtualProtect",
                    "VirtualQuery",
                    "WaitForSingleObject"
                ],
                "USER32.dll": [
                    "MessageBoxA"
                ],
                "WS2_32.dll": [
                    "WSACleanup",
                    "WSAConnect",
                    "WSASocketA",
                    "WSAStartup",
                    "closesocket",
                    "htons",
                    "inet_addr",
                    "recv"
                ]
            },
            "iocs": [
                {
                    "type": "sha256",
                    "Value": "c8420237b108ab3a1ea1f2aaa1476a8213051f78177c1ce97c9a38250798cb27",
                    "Comments": "sha256 Hash of the stage2.exe"
                },
                {
                    "type": "imphash",
                    "Value": "040bf8c6dc77209e89ac091aee70ec76",
                    "Comments": "Imphash of stage2.exe"
                },
                {
                    "type": "PE_string",
                    "Value": "C:\\malware\\ch0nky.txt",
                    "Comments": "setting an environment for the malware to run"
                },
                {
                    "type": "IP",
                    "Value": "167.172.135.86",
                    "Comments": "Evil IP"
                },
                {
                    "type": "file_name",
                    "Value": "stage2.exe",
                    "Comments": "dropped file"
                }
            ],
            "mitre_att&ck": {
                "TA0002": {
                    "Techniques": [
                        "T1106",
                        "T1059"
                    ],
                    "Comments": "<Native API:Call to CreateProcess> and abuses powershell commands to execute PE"
                },
                "TA0011": {
                    "Techniques": [
                        "T1071",
                        "T1132"
                    ],
                    "Comments": "<Application Layer Protocol:Downloads binaries from C2> and hiding the IP address in stack string"
                },
                "TA0005": {
                    "Techniques": [
                        "T1564"
                    ],
                    "Comments": "<Hide Artifacts:FreeConsole>"
                }
            },
            "verdict": true,
            "classification": "loader",
            "verdict_justification": "communicates with C2 and downloads binaries from it"
        }
    ],
    "Flags":
    [
        "FLAG{Dr0pItLik3ItsH0t}", 
        "FLAG{DoesItGoesWithoutSayingThatImplicitly>ThanExplicit?}"
    ],
    "C2s":["167.172.135.86", "ch0nky.chickenkiller.com"]
}